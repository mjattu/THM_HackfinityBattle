![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_1.png){width="5.758333333333334in"
height="1.7229166666666667in"}\
This is a Cloud Category Challenge!\
\
There is a website link, lets see if we find something:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_2.png){width="5.759722222222222in"
height="2.428472222222222in"}

This is a login page, on entering random credentials we get this:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_3.png){width="5.761805555555555in"
height="1.8756944444444446in"}

It means the method is not allowed.

Since it is a s3 bucket website, lets see if we can find the s3 bucket!\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_4.png){width="5.145833333333333in"
height="1.0208333333333333in"}

We got a captured logins folder, lets see whats inside:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_5.png){width="5.761805555555555in"
height="1.2368055555555555in"}

We got the final flag!\|

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_6.png){width="5.757638888888889in"
height="1.70625in"}\
This is a web based ctf, here we need to see if anything is lying around
the website.\
\
When we open it, we see a PGP Encryption Tool website:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_13.png){width="5.766666666666667in"
height="1.6861111111111111in"}

If we try to do command injection, we get success:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_14.png){width="4.604166666666667in"
height="1.3541666666666667in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_15.png){width="5.074305555555555in"
height="2.060416666666667in"}

So lets try to display the flag.txt:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_16.png){width="5.759722222222222in"
height="1.5465277777777777in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_17.png){width="5.760416666666667in"
height="2.1493055555555554in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_18.png){width="5.761805555555555in"
height="0.49444444444444446in"}

Version2:\
\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_19.png){width="5.758333333333334in"
height="1.4076388888888889in"}

This is the DarkEncryptor 2, lets see the website:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_20.png){width="5.763888888888889in"
height="1.9784722222222222in"}

We can upload a file here, lets see if it is also vulnerable to command
injection!\
On uploading any file we get a gpg file:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_70.png){width="5.427083333333333in"
height="2.0833333333333335in"}

We cant unencrypt it because we don't have the gpg key, this type of
challenges generally have command injection vulnerability due to
improper imput validation.

Lets try that, with a remote shell

First we need to setup the netcat listening server: nc -lvnp 4444

Then we will intercept the reuqest and add our command injection
payload.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_81.png){width="4.710416666666666in"
height="2.3333333333333335in"}\
Remember to correctly add the semicolons, else it will not work.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_92.png){width="3.21875in"
height="1.5131944444444445in"}

Now here we got the list f files, now we can simply see the flag.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_103.png){width="4.1875in"
height="0.46875in"}

Remember to reset the nc listening server!

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_114.png){width="3.3243055555555556in"
height="0.7006944444444444in"}\
\
We got the flag!

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_125.png){width="4.629861111111111in"
height="0.45902777777777776in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_21.png){width="5.146527777777778in"
height="2.1527777777777777in"}

This is a crypto category challenge. Here we are prompted to a machine
to find the ransomware decryption key. Acc to the hint the tmp directory
has something which will help us to decode it.

In the tmp directory we got a public_key.txt file with values of n and
e, it seems its an RSA encryption.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_22.png){width="4.882638888888889in"
height="0.9673611111111111in"}

Lets us find the other values: ( Acc to the hint we need the RSA private
key "d")

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_23.png){width="4.6097222222222225in"
height="2.2375in"}

We got value of d, on putting it in the ransomware key, we get a popup
files decryptyed:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_24.png){width="4.542361111111111in"
height="2.5027777777777778in"}

We can see two files in Desktop:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_25.png){width="3.5in"
height="3.28125in"}\
\
On exploring both files, we get the flag in Grades file:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_26.png){width="5.763888888888889in"
height="2.917361111111111in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_27.png){width="4.6875in"
height="0.6354166666666666in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_28.png){width="5.7555555555555555in"
height="2.375in"}

This is a red teaming category challenge. Here we have a dump of LSASS
process, and from that we need critical credentials to login.

If you don't know, LSASS stands for Local Security Authority Subsystem
Service.LSASS is responsible for enforcing security policies on Windows
systems, and dumping its memory can reveal plaintext passwords, NTLM
hashes, and other sensitive authentication data. We can login to the
system using LSASS memory dumps.

Generally we need mimikatz or some other tool to extract the LSASS dump,
but here the extracted txt file is already give. From this we can find
that:\
There are a lot of login entries, but how should we find which one has
admin access?

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_32.png){width="5.768055555555556in"
height="3.8625in"}

So lets check for administator:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_33.png){width="5.7652777777777775in"
height="2.7618055555555556in"}

Also its SID is S-1-5-21, lets see if we can login through the NTLM Hash
and the Administrator account.\
\
For this we will use EvilWinRM:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_34.png){width="5.764583333333333in"
height="1.1604166666666667in"}

We got an Error, lets try with some othe users having similar SID:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_35.png){width="5.761805555555555in"
height="2.1020833333333333in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_36.png){width="5.764583333333333in"
height="1.0152777777777777in"}

We got the access of the machine, now lets check if we have the admin
access, using the command:\
net localgroup Administrators:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_37.png){width="5.766666666666667in"
height="1.413888888888889in"}

So we don't have the admin rights(Byte Reaper), lets login with Cipher!

We get Error, lets try with DarkInjector:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_38.png){width="5.764583333333333in"
height="1.0722222222222222in"}

We got the access, now lets see in Desktop folder, if we get anything:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_39.png){width="5.766666666666667in"
height="1.4375in"}

We did not found anything, lets see on the other user desktop folders:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_290.png){width="5.764583333333333in"
height="3.009027777777778in"}

Finally we got the flag inside Administrator/Desktop:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_301.png){width="5.7659722222222225in"
height="2.227777777777778in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_312.png){width="4.864583333333333in"
height="0.625in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_40.png){width="5.764583333333333in"
height="2.046527777777778in"}

This is a Cloud category challenge!\
\
We have a access key id and secret access key, lets login!

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_44.png){width="5.739583333333333in"
height="1.0520833333333333in"}

Now lets see the s3 bucket, mentioned in the problem statement.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_45.png){width="5.239583333333333in"
height="0.96875in"}

Lets download the file and see whats inside:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_46.png){width="6.422916666666667in"
height="1.79375in"}

This is a KMS Encrypted file, with symmetric key.

First we need to create a file of the ciphertext with decoded base 64:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_47.png){width="5.764583333333333in"
height="2.060416666666667in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_48.png){width="5.768055555555556in"
height="1.0402777777777779in"}

But we got an error, that we can access decypt operation.\
\
So lets see if IAM service is there...

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_49.png){width="5.7659722222222225in"
height="2.495138888888889in"}

Yes IAM is there! Lets find for some interesting role:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_50.png){width="5.761111111111111in"
height="3.4131944444444446in"}

We got a role that can encrypt/decrypt messages for cipher.

So now we need the credentials of this role!\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_51.png){width="5.768055555555556in"
height="2.0965277777777778in"}

Now lets export the keys:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_410.png){width="5.761805555555555in"
height="1.9506944444444445in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_421.png){width="5.768055555555556in"
height="2.2472222222222222in"}

We got the final flag.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_432.png){width="5.072916666666667in"
height="0.5208333333333334in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_52.png){width="5.761111111111111in"
height="2.420138888888889in"}

This is a LLM Category challenge, where I need to find the flag from the
machine.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_53.png){width="3.8819444444444446in"
height="2.2423611111111112in"}

On starting the nc does not provides any response, so as per instructed
in the statement we waited for 5 minutes.

So this is a Linux Machine LLM Model, which helps us to execute linux
commands on the machine. On pwning I got the list of files present in
the directory, where I see a evilai.py.\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_54.png){width="5.5in"
height="0.9895833333333334in"}

On inspecting it, It seems to be the code for this AI, but nothing
special we got from that file. So moving on I tried to see if there is
anythig in any of this folder, like a flag .txt. So I did tree:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_55.png){width="3.011111111111111in"
height="3.1930555555555555in"}

But did not got anything like that, so I tried to see whats inside the
Root Folder.

But "cd" command is not working here, so I think I need to directly use
"ls" command:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_56.png){width="5.354166666666667in"
height="0.7708333333333334in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_57.png){width="4.6875in"
height="1.2291666666666667in"}

We can see the flag.txt file. Now for reading this I tried echo, nano,
find and xyz tools but when I try to execute the command gets changed.
So we need to think something beyond this.\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_58.png){width="5.7625in"
height="2.60625in"}

So I realized that is a LLM challenge, so we can give generative prompt,
lets ask AI to print the file from the folder. After lot of trial and
error we got it:\
\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_59.png){width="5.761111111111111in"
height="0.5159722222222223in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_60.png){width="4.364583333333333in"
height="0.6041666666666666in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_61.png){width="5.758333333333334in"
height="1.9493055555555556in"}

This is another LLM Challenge, here we need to extract the flag from the
AI\
\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_62.png){width="5.433333333333334in"
height="3.238888888888889in"}

On asking for the flag, it says it cant disclose it.

At this moment I be like " OKAY, LETS SEE HOW CAN IGNORE ME, HAHA...
(EVIL LAUGH)"\
\
Then I asked if it has anything like THM{}, if so to reveal that. It be
like: "I'M NOOB"\
\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_63.png){width="5.320138888888889in"
height="1.7847222222222223in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_64.png){width="3.84375in"
height="0.7291666666666666in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_65.png){width="5.7625in"
height="3.0625in"}\
\
This is a Red Teaming category challenge!\
\
Here we have to login to a mail, and perform phishing! It simulate real
world hacking scenario.\
\
First we are asked to enter the credentials to login: (given in the
problem statement)\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_66.png){width="4.8590277777777775in"
height="2.15625in"}

There is a unread mail, requesting for a report!\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_67.png){width="5.757638888888889in"
height="1.136111111111111in"}\
\
Let us first send a sample txt file.\
We got a reply stating that to send .docx or .docm\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_68.png){width="5.767361111111111in"
height="2.267361111111111in"}\
\
Here we can add some malicious payloads in the file and send it, for
reverse shell.\
\
Lets use metasploit to create a .docm file with the exploit.\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_69.png){width="5.763888888888889in"
height="1.617361111111111in"}\
\
Now we got the document as msf.docm, now lets create a multihandler
listener for listening to reverse connection.\
\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_70.png){width="5.761805555555555in"
height="2.620138888888889in"}

Now lets send the file, and see for any reverse connection.\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_71.png){width="5.7659722222222225in"
height="2.204861111111111in"}

We got a reply... checking the attachment!\
\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_72.png){width="5.761111111111111in"
height="0.6416666666666667in"}\
We got a reverse connection.\
\
Lets perform some basic commands and see if we get something:\
Generally the flag is kept in the Deskotp folder, lets check it:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_73.png){width="5.7659722222222225in"
height="1.8166666666666667in"}

Finally we go it!

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_74.png){width="5.764583333333333in"
height="3.2625in"}\
\
This is a Read Teaming Category challenge.

We got the email credentials, we need to login to the mail first.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_75.png){width="5.7625in"
height="2.8555555555555556in"}

There is a unread mail requesting for a exe installation file for
Win10x64.\
And we need to send it to them with loading malicious payload , so that
we can get a reverse tcp shell.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_76.png){width="5.763194444444444in"
height="0.9569444444444445in"}

We created the .exe file using msfvenom. Now lets start the reverse
shell for listening:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_77.png){width="5.0625in"
height="0.6041666666666666in"}

Now lets send the .exe file through the mail

We did not got any reply, but we got a connection:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_78.png){width="5.760416666666667in"
height="0.8104166666666667in"}

Lets now see if we can find the flag:\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_79.png){width="5.764583333333333in"
height="1.6243055555555554in"}

We got the flag in the Desktop folder!\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_80.png){width="5.145833333333333in"
height="0.5208333333333334in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_81.png){width="5.764583333333333in"
height="3.3159722222222223in"}

This is a Red Teaming Challenge. This is the v2 of Shadow Phishing
challenge. The challenge is termed as Hard. Lets give it a try.\
\
We have the credentials of mail to login, lets login and see what they
demand now:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_82.png){width="5.766666666666667in"
height="1.7201388888888889in"}

Okay so they again asking for exe file, lets try the previous payload
and set the listening port.

Refer to my Shadow Phishing CTF writeup for the steps.

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_83.png){width="4.555555555555555in"
height="2.125in"}

It shows an error in file, most probably the virus has been identified.
Lets try to bypass it:

Lets try to encode the payload\
![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_84.png){width="5.75625in"
height="2.3180555555555555in"}

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_85.png){width="5.763194444444444in"
height="1.7569444444444444in"}\
\
Lets start the listening port

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_86.png){width="4.84375in"
height="0.5in"}

Now lets send the payload, no virus detected by the mail...

After sending the payload we got no connections in the port, it might be
that the receiver identified it as virus, so we check it by again
sending the same payload exe file. And we get virus detected error:

![](vertopal_104a0b07bcda491fb5f9aba671db139b/media/image_87.png){width="2.1770833333333335in"
height="0.8645833333333334in"}

So we need to try another method:
